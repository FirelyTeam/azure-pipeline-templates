
parameters:
  - name: nuGetServiceConnections
    type: string
    displayName: 'Service connections to additional NuGet feeds (optional)'
  - name: nuGetSources
    type: string
    displayName: 'Additional NuGet sources (optional)'
  - name: solutionFile
    type: string
    default: ''
    displayName: 'Solution file for dotnet restore (if not provided, all .sln files in the working directory are used)'

steps:
  - ${{if parameters.nuGetServiceConnections}}:
    - task: NuGetAuthenticate@1
      inputs:
        nuGetServiceConnections: ${{ parameters.nuGetServiceConnections }}

  - script: |
      if [ -n "${{ parameters.solutionFile }}" ]; then
        dotnet restore "${{ parameters.solutionFile }}" --source https://api.nuget.org/v3/index.json ${{ parameters.nuGetSources }}
      else
        dotnet restore --source https://api.nuget.org/v3/index.json ${{ parameters.nuGetSources }}
      fi
    displayName: 'dotnet restore'